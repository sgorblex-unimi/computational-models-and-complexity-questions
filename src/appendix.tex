\chapter{Useful constructions}
% TODO: introduction

For the following, given a transition function $\delta$, a set of states $S$, and a symbol $\sigma$, we define
\begin{equation*}
	\delta(S,\sigma):=\bigcup_{q\in S} \delta(q,\sigma) \text.
\end{equation*}
We also use the transitive closure of $\delta$ in order to use strings as second argument.



\section{Modifications of \NFAs}


\subsection{\NFAs with multiple starting states}
% TODO: context. Mention that eps-transitions can not be eliminated cheaply in general (citation), so using eps-transitions is not a so immediate solution
\begin{thrm}
	Every $n$-state NFA with multiple starting states can be simulated by an $(n+1)$-state NFA with a single starting state.
\end{thrm}
\begin{proof}
	Let $A:=(Q,\Sigma,\delta,I,F)$ a multiple starting state NFA, where $I\subseteq Q$ is the set of starting states.
	Define the NFA $A':=(Q',\Sigma,\delta',q_I,F')$, where
	\begin{itemize}
		\item $Q':=Q\cup\set{q_I}$,
		\item $q_I\notin Q$ is the new, only starting state
		\item $\delta'$ is defined as follows:
		      \begin{itemize}
			      \item $\delta'(q_I,\sigma):=\delta(I,\sigma)$
			      \item for all $q\ne q_I$, $\delta'(q,\sigma)=\delta(q,\sigma)$, and
		      \end{itemize}
		\item $F':=F\cup\set{q_I\mid I\cap F\ne\emptyset}$
	\end{itemize}
	The logic behind the construction is that the new state simulates the behavior of all the original starting states at the same time, by making use of nondeterminism and creating "short circuits" for the transitions from the original starting states.

	Obviously, if $n:=\card Q$, then $\card{Q'}=\card Q+1=n+1$. Therefore, it is only left to prove that $\genlang(A)=\genlang(A')$.
	We start from the definition of $\genlang(A')$ and we temporarily ignore the possible presence of the empty word:
	\begin{align*}
		\genlang(A')\setminus\set{\emptyword} & = \set{w\in\Sigma\plus\mid \delta'(q_I,w)\cap F'\ne\emptyset}
	\end{align*}
	Because $F'$ can only differ from $F$ by the possible presence of $q_I$, and $q_I\notin\delta'(q_I,w)$ for any $w\in\Sigma\plus$, we have that $\delta'(q_I,w)\cap F'=\delta'(q_I,w)\cap F$:
	\begin{align*}
		 & = \set{w\in\Sigma\plus\mid \delta'(q_I,w)\cap F\ne\emptyset}                                                                    \\
		 & = \set{w\in\Sigma\plus\mid w=\sigma x, x\in\Sigma\star,\sigma\in\Sigma,\delta'(q_I,\sigma x)\cap F\ne\emptyset}                 \\
		 & = \set{w\in\Sigma\plus\mid w=\sigma x, x\in\Sigma\star,\sigma\in\Sigma,\delta'(\delta'(q_I,\sigma),x)\cap F\ne\emptyset} \text.
	\end{align*}
	By definition of $\delta(q_I,\cdot)$, the last set is equal to
	\begin{align*}
		 & = \set{w\in\Sigma\plus\mid w=\sigma x, x\in\Sigma\star,\sigma\in\Sigma,\delta'(\delta(I,\sigma),x)\cap F\ne\emptyset} \text.
	\end{align*}
	Because $q_I\notin\delta(I,\sigma)$, in the last expression $\delta'$ can be replaced with $\delta$, as per its definition:
	\begin{align*}
		 & = \set{w\in\Sigma\plus\mid w=\sigma x, x\in\Sigma\star,\sigma\in\Sigma,\delta(\delta(I,\sigma),x)\cap F\ne\emptyset} \\
		 & = \set{w\in\Sigma\plus\mid w=\sigma x, x\in\Sigma\star,\sigma\in\Sigma,\delta(I,\sigma x)\cap F\ne\emptyset}         \\
		 & = \set{w\in\Sigma\plus\mid \delta(I,w)\cap F\ne\emptyset}                                                            \\
		 & = \genlang(A)\setminus\set{\emptyword} \text.
	\end{align*}

	As for the possible presence of the empty word in $\genlang(A)$ and $\genlang(A')$:
	\begin{align*}
		\emptyword\in\genlang(A') & \iff q_0\in F'                                     \\
		                          & \iff q_0\in F\cup\set{q_0\mid I\cap F\ne\emptyset} \\
		                          & \iff I\cap F\ne\emptyset                           \\
		                          & \iff \emptyword\in\genlang(A) \text. \qedhere
	\end{align*}
\end{proof}


\subsection{Languages with a symbol prefix or suffix}
% TODO: adaptation of the previous subsec to transform an NFA for xL in an NFA for L; construction for the mirrored problem; conclusions on the fact that we can build an NFA for lem L rem and then converting it in one for L
